{% extends "base.html" %}

{% block css %}
<link rel="stylesheet" type="text/css" href="{{ urlFor("/css/checkout.css") }}">
{% endblock %}

{% block content_header %}
<a class="breadcrumb" href="{{ urlFor("store") }}/cart/">
    <span class="back-arrow">&#8592;</span><span>BACK</span>
</a>
<h1>Checkout</h1>
{% endblock %}

{% block content_header_width_class %}checkout-width{% endblock %}

{% block content_width_class %}checkout-width{% endblock %}

{% block content %}
<div class="checkout sep-top">
    <div class="order-information col-1-2">
        <form id="form" action="{{ urlFor("checkout", "/charge") }}" method="post" name="form">
            {% for item in order.Items %}
                <input type="hidden" name="Order.Items.{{ forloop.Counter }}.Product.Slug" value="{{ item.Slug() }}">
                <input type="hidden" name="Order.Items.{{ forloop.Counter }}.Variant.SKU" value="{{ item.SKU() }}">
                <input type="hidden" name="Order.Items.{{ forloop.Counter }}.Quantity" value="{{ item.Quantity }}">
            {% endfor %}

            <div class="billing-information">
                <h2>Billing Info</h2>

                <fieldset>
                    <!-- First Name -->

                    <div id="billing-first-name" class="field first-name required">
                        <label>First Name</label>
                        <input name="User.FirstName" placeholder="First Name" x-autocompletetype="given-name" type="text" spellcheck="false" maxlength="30" value="">
                    </div>
                    <!-- Last Name -->

                    <div id="billing-last-name" class="field last-name required">
                        <label>Last Name</label>
                        <input name="User.LastName" placeholder="Last Name" x-autocompletetype="surname" type="text" spellcheck="false" maxlength="30" value="">
                    </div>
                    <!-- Email Address -->

                    <div id="email" class="field email required">
                        <label>Email Address</label>
                        <input name="User.Email" placeholder="Email" x-autocompletetype="email" type="text" spellcheck="false" maxlength="50" value="">
                    </div>
                    <!-- Billing Address 1 -->

                    <div id="billing-address-1" class="field required">
                        <label>Address Line 1</label>
                        <input name="Order.BillingAddress.Line1" placeholder="Address Line 1" x-autocompletetype="address-line1" type="text" spellcheck="false" maxlength="50" aria-autocomplete="list" aria-expanded="false" autocomplete="on" value="">
                    </div>
                    <!-- Billing Address 2 -->

                    <div id="billing-address-2" class="field">
                        <label>Address Line 2</label>
                        <input name="Order.BillingAddress.Line2" placeholder="Address Line 2" type="text" x-autocompletetype="address-line2" spellcheck="false" maxlength="50" value="">
                    </div>
                    <!-- City -->

                    <div id="billing-city" class="field city required">
                        <label>City</label>
                        <input name="Order.BillingAddress.City" placeholder="City" type="text" spellcheck="false" maxlength="30" value="">
                    </div>
                    <!-- State/Province -->

                    <div id="billing-state" class="field state required">
                        <label>State/Province</label>
                        <input name="Order.BillingAddress.State" placeholder="State/Province" type="text" spellcheck="false" x-autocompletetype="state" value="">
                    </div>
                    <!-- Zip Code -->

                    <div id="billing-zip" class="field zip required">
                        <label>Zip / Postal</label>
                        <input name="Order.BillingAddress.PostalCode" placeholder="Zip / Postal" type="text" spellcheck="false" maxlength="9">
                        <!--http://stackoverflow.com/a/469362-->
                    </div>
                    <!-- Country -->

                    <div id="billing-country" class="field country required">
                        <label>Country</label>
                        <input name="Order.BillingAddress.Country" type="text" spellcheck="false" placeholder="Country" x-autocompletetype="country-name" value="">
                    </div>
                    <!-- Phone -->

                    <div id="phone" class="field phone required">
                        <label>Phone Number</label>
                        <input name="User.Phone" placeholder="(424)-424-4200" x-autocompletetype="phone" type="text" spellcheck="false" maxlength="20" value="">
                    </div>
                    <!-- Continue -->

                    <div class="btn-container" style="text-align: center;">
                        <!--<input type="submit" value="Continue" class="button continue-button" style="width:100%"></input>-->
                    </div>
                </fieldset>
            </div>

            <div class="shipping-information">
                <h2>Shipping Info</h2>
                <div class="options">
                    <input name="ShipToBilling" type="checkbox" checked>
                    <label>Ship to Billing Address</label>
                </div>

                <fieldset style="display:none">
                    <!-- Shipping Address 1 -->

                    <div id="shipping-address-1" class="field required">
                        <label>Address Line 1</label>
                        <input name="Order.ShippingAddress.Line1" placeholder="Address Line 1" x-autocompletetype="address-line1" type="text" spellcheck="false" maxlength="50" aria-autocomplete="list" aria-expanded="false" autocomplete="on" value="">
                    </div>
                    <!-- Shipping Address 2 -->

                    <div id="shipping-address-2" class="field">
                        <label>Address Line 2</label>
                        <input name="Order.ShippingAddress.Line2" placeholder="Address Line 2" type="text" x-autocompletetype="address-line2" spellcheck="false" maxlength="50" value="">
                    </div>
                    <!-- City -->

                    <div id="shipping-city" class="field city required">
                        <label>City</label>
                        <input name="Order.ShippingAddress.City" placeholder="City" type="text" spellcheck="false" maxlength="30" value="">
                    </div>
                    <!-- State/Province -->

                    <div id="shipping-state" class="field state required">
                        <label>State/Province</label>
                        <input name="Order.ShippingAddress.State" placeholder="State/Province" type="text" spellcheck="false" x-autocompletetype="state" value="">
                    </div>
                    <!-- Zip Code -->

                    <div id="shipping-zip" class="field zip required">
                        <label>Zip / Postal</label>
                        <input name="Order.ShippingAddress.PostalCode" placeholder="Zip / Postal" type="text" spellcheck="false" maxlength="9">
                        <!--http://stackoverflow.com/a/469362-->
                    </div>
                    <!-- Country -->

                    <div id="shipping-country" class="field country required">
                        <label>Country</label>
                        <input name="Order.ShippingAddress.Country" type="text" spellcheck="false" placeholder="Country" x-autocompletetype="country-name" value="">
                    </div>
                    <!-- Continue -->

                    <div class="btn-container" style="text-align: center;">
                        <!--<input type="submit" value="Continue" class="button continue-button" style="width:100%"></input>-->
                    </div>
                </fieldset>
            </div>

            <div class="payment-information">
                <h2>
                    <span class="payment-title">Payment</span>
                    <span class="payment-cards">
                        <img src="{{ urlFor("/img/discover.png") }}">
                        <img src="{{ urlFor("/img/mastercard.png") }}">
                        <img src="{{ urlFor("/img/visa.png") }}">
                        <img src="{{ urlFor("/img/americanexpress.png") }}">
                    </span>
                </h2>

                <fieldset>
                    <div style="display:block; text-align:center; margin-bottom: 5%;">
                        <div id="card-wrapper"></div>
                    </div>
                    <!-- Credit Card -->

                    <div class="credit-card">
                        <!-- Name -->
                        <div class="card-name field required">
                            <label>Name As It Appears On Card</lable>
                            <input type="text"
                            id="stripe-name" placeholder="Name">
                        </div>
                        <!-- Card Number -->

                        <div class="card-number field required">
                            <label>Card Number</label>
                            <input type="text" size="20" autocomplete="off"
                            placeholder="Credit Card Number" value=""
                            id="stripe-number">
                        </div>

                        <div class="expiry-cvc">
                            <!-- CVC -->

                            <div class="card-cvc field required">
                                <label>CVC</label>
                                <input type="text" size="4"
                                autocomplete="off" placeholder="CVC" value=""
                                id="stripe-cvc">
                            </div>
                            <!-- Expiration -->

                            <div class="card-expiry-month field required">
                                <label>Expiration</label>
                                <input type="text" size="2" maxlength="2"
                                autocomplete="off" placeholder="MM"
                                value="" id="stripe-expiry-month">
                            </div>

                            <div class="card-expiry-year field required">
                                <label>&nbsp;</label>
                                <input type="text" size="4" maxlength="4"
                                autocomplete="off" placeholder="YYYY" value=""
                                id="stripe-expiry-year">
                            </div>

                        </div>
                        <!-- Secure payment conditions -->

                        <div id="comfort" style="display:none;">
                            All transactions are secure and encrypted, and we never store your credit card information. Payments are processed through Stripe. Payment information is also governed by <a target="_blank" href="https://stripe.com/privacy">Stripe's privacy policy</a>.
                        </div>
                        <!-- Authorize message display -->

                        <div class="authorizeMessage" id="authorize-message"></div>
                        <!-- Place Order -->

                        <div class="btn-container" style="text-align: center;">
                            <button type="submit">Place Order</button>
                        </div>

                    </div>
                </fieldset>
            </div>
            <input type="hidden" name="StripeToken">
        </form>
    </div>

    <div class="cart-content col-1-2">
        <h2>Order Summary</h2>
        <table>
            <thead>
                <tr>
                    <td class="item" colspan="2">Item</td>
                    <td class="quantity">Quantity</td>
                    <td class="price">Price</td>
                </tr>
            </thead>
            <tbody>
                {% for item in order.Items %}
                <tr>
                    <td class="item-image">
                        <img src="{{ item.Product.DisplayImage().Url }}">
                    </td>
                    <td class="item-desc">
                        <div class="product-title">
                            {{ item.Product.Title }}
                        </div>

                        <div class="variant-info">
                            {{ item.DisplayShortDescription() }}
                        </div>
                    </td>

                    <td class="quantity">
                        <span>
                            {{ item.Quantity }}
                        </span>
                    </td>

                    <td class="price">
                        <span>$</span><span class="money">{{ item.DisplayPrice() }}</span>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <table class="totals">
            <tbody>
                <tr class="subtotal">
                    <td class="label"colspan="3">
                        <span>Subtotal</span>
                    </td>
                    <td class="value">
                        <span>$</span><span>{{ order.DisplaySubtotal() }}<span>
                    </td>
                </tr>

                <tr class="tax">
                    <td class="label"colspan="3">
                        <span>Tax</span>
                    </td>
                    <td class="value">
                        <span>$</span><span class="price">{{ order.DisplayTax() }}<span>
                    </td>
                </tr>

                <tr class="shipping">
                    <td class="label"colspan="3">
                        <span>Shipping</span>
                    </td>
                    <td class="value">
                        <span>$</span><span class="price">{{ order.Shipping }}<span>
                    </td>
                </tr>

                <tr class="grand-total">
                    <td class="label"colspan="3">
                        <span>Grand Total</span>
                    </td>
                    <td class="value">
                        <span>$</span><span class="price">{{ order.DisplayTotal() }}<span>
                    </td>
                </tr>
            </tbody>
        </table>

    </div>
    <!-- POLICIES -->

    <div class="policy-information">
        <!-- Terms of Service -->
        <a href="javascript:void(0)" id="termsOfService" class="store-policy-link" title="Terms Of Service">Terms of Service</a>
        <!-- Privacy Policy -->
        <a href="javascript:void(0)" id="privacyPolicy" class="store-policy-link" title="Privacy Policy">Privacy Policy</a>
        <!-- Return Policy -->
        <a href="javascript:void(0)" id="returnPolicy" class="store-policy-link" title="Return Policy">Return Policy</a>
    </div>
</div>

<form id="stripeForm" action="" method="post" accept-charset="UTF-8" enctype="application/x-www-form-urlencoded; charset=utf-8" name="stripeForm">
    <input type="hidden" data-stripe="number">
    <input type="hidden" data-stripe="cvc">
    <input type="hidden" data-stripe="exp-month">
    <input type="hidden" data-stripe="exp-year">
</form>
{% endblock %}

{% block js %}
<script type="text/javascript" src="https://js.stripe.com/v2/"></script>
<script type="text/javascript">Stripe.setPublishableKey('{{ config.Stripe.APIKey }}');</script>
<script type="text/javascript" src="{{ urlFor("/js/checkout.js") }}"></script>
{% endblock %}
