{% extends "base.html" %}

{% block name %}Order{% endblock %}

{% block css %}
{% endblock %}

{% block content %}
<!-- Order information Form Block -->
<div class="col-sm-10 col-sm-offset-1 col-md-10 col-md-offset-1 col-lg-8 col-lg-offset-1">
    <div class="block">
        <!-- Order information Form Title -->
        <div class="block-title">
            <h2>Order Information</h2>
        </div>
        <!-- END Order information Form Title -->

        <!-- Order information Form Content -->
        <order-form>
          <h4>
            <a data-toggle="collapse" href="#order-info">
              Information
            </a>
          </h4>
          <div id="order-info" class="collapse in block">
              <control label="ID" input="{ inputs.id }"></control>
              <control label="Number" input="{ inputs.number }"></control>
              <control label="Created On" input="{ inputs.createdAt }"></control>
              <control label="Last Updated On" input="{ inputs.updatedAt }"></control>
              <div class="form-group form-actions">
                <div class="col-md-9 col-md-offset-3">
                  <button type="button" class="resend-btn btn btn-effect-ripple btn-primary">Resend Confirmation</button>
                  <button type="submit" class="btn btn-effect-ripple btn-primary">Save</button>
                  <button type="reset" class="btn btn-effect-ripple btn-warning">Reset</button>
                </div>
              </div>
          </div>

          <h4>
            <a data-toggle="collapse" href="#user-info">
              User Information
            </a>
          </h4>
          <div id="user-info" class="collapse in block">
              <order-user-static-form obs="{ obs }">
                  <control label="ID" input="{ inputs.id }"></control>
                  <control label="Email" input="{ inputs.email }"></control>
                  <control label="First Name" input="{ inputs.firstName }"></control>
                  <control label="Last Name" input="{ inputs.lastName }"></control>
                  <control label="Phone" input="{ inputs.phone }"></control>
                  <control label="Created On" input="{ inputs.createdAt }"></control>
                  <control label="Last Updated On" input="{ inputs.updatedAt }"></control>
              </order-user-static-form>
          </div>
          <h4>
            <a data-toggle="collapse" href="#order-shipping-address">
              Shipping Address
            </a>
          </h4>
          <div id="order-shipping-address" class="collapse in block">
              <control label="Street Address" input="{ inputs['shippingAddress.line1'] }"></control>
              <control label="Apt/Suite Number" input="{ inputs['shippingAddress.line2'] }"></control>
              <control label="City" input="{ inputs['shippingAddress.city'] }"></control>
              <control label="State" input="{ inputs['shippingAddress.state'] }"></control>
              <control label="Postal/ZIP Code" input="{ inputs['shippingAddress.postalCode'] }"></control>
              <control label="Country" input="{ inputs['shippingAddress.country'] }"></control>
              <div class="form-group form-actions">
                <div class="col-md-9 col-md-offset-3">
                    <button type="submit" class="btn btn-effect-ripple btn-primary">Save</button>
                  <button type="reset" class="btn btn-effect-ripple btn-warning">Reset</button>
                </div>
              </div>
          </div>
          <h4>
            <a data-toggle="collapse" href="#order-items">
              Items
            </a>
          </h4>
          <div id="order-items" class="collapse in block">
              <item-list obs="{ obs }">
              No Items Found
            </item-list>
          </div>
          <h4>
            <a data-toggle="collapse" href="#order-payments">
              Payments
            </a>
          </h4>
          <div id="order-payments" class="collapse in block">
            <payment-list path="{ 'order/'+opts.id+'/payments' }">
              No Payments Found
            </payment-list>
          </div>
          <div class="row">
            <div class = "col-xs-6">
              <h4>
                <a data-toggle="collapse" href="#order-payment">
                  Payment Information
                </a>
              </h4>
              <div id="order-payment" class="collapse in block">
                  <control label="Currency" input="{ inputs.currency }" labelClasses="col-md-5" controlClasses="col-md-7"></control>
                  <control label="Line Total" input="{ inputs.lineTotal }" labelClasses="col-md-5" controlClasses="col-md-7"></control>
                  <control label="Discount" input="{ inputs.discount }" labelClasses="col-md-5" controlClasses="col-md-7"></control>
                  <control label="Subtotal" input="{ inputs.subtotal }" labelClasses="col-md-5" controlClasses="col-md-7"></control>
                  <control label="Shipping" input="{ inputs.shipping }" labelClasses="col-md-5" controlClasses="col-md-7"></control>
                  <control label="Tax" input="{ inputs.tax }" labelClasses="col-md-5" controlClasses="col-md-7"></control>
                  <control label="Total" input="{ inputs.total }" labelClasses="col-md-5" controlClasses="col-md-7"></control>
              </div>
            </div>
            <div class = "col-xs-6">
              <h4>
                <a data-toggle="collapse" href="#order-status">
                  Status
                </a>
              </h4>
              <div id="order-status" class="collapse in block">
                  <control label="Status" input="{ inputs.status }" labelClasses="col-md-6" controlClasses="col-md-6"></control>
                  <control label="Payment Status" input="{ inputs.paymentStatus }" labelClasses="col-md-6" controlClasses="col-md-6"></control>
                  <control label="Fulfillment Status" input="{ inputs.fulfillmentStatus }" labelClasses="col-md-6" controlClasses="col-md-6"></control>
              </div>
            </div>
          </div>
          <div class="form-group form-actions">
            <div class="col-md-9 col-md-offset-3">
              <button type="submit" class="btn btn-effect-ripple btn-primary">Submit</button>
              <button type="reset" class="btn btn-effect-ripple btn-warning">Reset</button>
            </div>
          </div>
        </order-form>
        <!-- END Order information Form Content -->
    </div>
    <!-- END Order information Form Block -->
</div>
<!-- END Order information Form Block -->
{% endblock %}

{% block js %}
<script>
  var countries = {
    {% for country in constants.Countries %}
        '{{ country.ISO3166OneAlphaTwo }}': '{{ country.ISO3166OneEnglishShortNameReadingOrder }}',
    {% endfor %}
  }

  var currencies = {
    {% for type in constants.CurrencyTypes %}
      '{{ type }}': '{{ type.Label() }}',
    {% endfor %}
  }

  $(function(){
    var urlParts = window.location.pathname.split('/')
    var id = urlParts.pop()

    new crowdcontrol.data.Api(
      '{{ urlFor("api") }}',
      '{{ ctx.organization.MustGetTokenByName("live-secret-key") }}'
    ).register('crowdstart')

    riot.mount('order-form', {id: id})

    $('.resend-btn').on('click', function(e){
      window.location.replace('{{ urlFor("platform", "sendorderconfirmation") }}' + '/' + id)
      e.preventDefault();
    })

  })
</script>
{% endblock %}

{% block menulink %}menu-orders{% endblock %}

