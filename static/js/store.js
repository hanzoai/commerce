(function(global){function rqzt(file,callback){if({}.hasOwnProperty.call(rqzt.cache,file))return rqzt.cache[file];if("function"==typeof callback)return void rqzt.load(file,callback);var resolved=rqzt.resolve(file);if(!resolved)throw new Error("Failed to resolve module "+file);var module$={id:file,rqzt:rqzt,filename:file,exports:{},loaded:!1,parent:null,children:[]},dirname=file.slice(0,file.lastIndexOf("/")+1);return rqzt.cache[file]=module$.exports,resolved.call(module$.exports,module$,module$.exports,dirname,file),module$.loaded=!0,rqzt.cache[file]=module$.exports}rqzt.modules={},rqzt.cache={},rqzt.resolve=function(file){return{}.hasOwnProperty.call(rqzt.modules,file)?rqzt.modules[file]:void 0},rqzt.define=function(file,fn){rqzt.modules[file]=fn},global.require=rqzt,rqzt.define("mvstar/lib/app",function(module,exports,__dirname,__filename,process){var App,ModelEmitter,Route,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};ModelEmitter=rqzt("mvstar/lib/model-emitter"),Route=rqzt("mvstar/lib/route"),App=function(_super){function App(state){var k,v;null==state&&(state={}),App.__super__.constructor.apply(this,arguments),this._routes={},this.views=[];for(k in state)v=state[k],this.state[k]=v}return __extends(App,_super),App.prototype.prefix="",App.prototype.addRoute=function(path,cb){var route;return null==(route=this._routes[path])&&(route=new Route(path,{prefix:this.prefix})),null==route.callbacks&&(route.callbacks=[]),route.callbacks.push(cb),this._routes[path]=route},App.prototype.setupRoutes=function(){var cb,k,v,_i,_len,_ref;_ref=this.routes;for(k in _ref)if(v=_ref[k],Array.isArray(v))for(_i=0,_len=v.length;_i<_len;_i++)cb=v[_i],this.addRoute(k,cb);else this.addRoute(k,v);return null},App.prototype.dispatchRoutes=function(){var cb,route,_,_i,_len,_ref,_ref1;_ref=this._routes;for(_ in _ref)if(route=_ref[_],route.regexp.test(location.pathname))for(_ref1=route.callbacks,_i=0,_len=_ref1.length;_i<_len;_i++)(cb=_ref1[_i])();return null},App.prototype.route=function(){return this.setupRoutes(),this.dispatchRoutes()},App}(ModelEmitter),module.exports=App}),rqzt.define("mvstar/lib/model-emitter",function(module,exports,__dirname,__filename,process){var EventEmitter,Model,ModelEmitter,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Model=rqzt("mvstar/lib/model"),EventEmitter=rqzt("mvstar/lib/event-emitter"),ModelEmitter=function(_super){function ModelEmitter(state){null==state&&(state={}),null==this.emitter&&(this.emitter=new EventEmitter),this.emitter.debug=this.debug,ModelEmitter.__super__.constructor.apply(this,arguments)}return __extends(ModelEmitter,_super),ModelEmitter.prototype.on=function(){return this.emitter.on.apply(this.emitter,arguments)},ModelEmitter.prototype.off=function(){return this.emitter.off.apply(this.emitter,arguments)},ModelEmitter.prototype.emit=function(){return this.emitter.emit.apply(this.emitter,arguments)},ModelEmitter}(Model),module.exports=ModelEmitter}),rqzt.define("mvstar/lib/model",function(module,exports,__dirname,__filename,process){var Model;Model=function(){function Model(state){var prop,value;null==state&&(state={}),this.state={},this.setDefaults(),this.transformAll();for(prop in state)value=state[prop],this.set(prop,value)}return Model.prototype.defaults={},Model.prototype.validators={},Model.prototype.transforms={},Model.prototype.setDefaults=function(){var prop,value,_ref;_ref=this.defaults;for(prop in _ref)value=_ref[prop],this.state[prop]=value;return this},Model.prototype.validate=function(prop,value){var validator;return null==prop?this.validateAll():null==(validator=this.validators[prop])||validator.call(this,value,prop)},Model.prototype.validateAll=function(){var prop;for(prop in this.validators)if(!this.validate(prop,this.state[prop]))return!1;return!0},Model.prototype.transform=function(prop,value){var transform;return null==prop?this.transformAll():null==(transform=this.transforms[prop])?value:transform.call(this,value,prop)},Model.prototype.transformAll=function(){var prop,transform,_ref;_ref=this.transforms;for(prop in _ref)transform=_ref[prop],this.state[prop]=transform.call(this,this.state[prop],prop);return this},Model.prototype.get=function(prop){return this.state[prop]},Model.prototype.set=function(prop,value){return!!this.validate(prop,value)&&(this.state[prop]=this.transform(prop,value),!0)},Model.prototype.remove=function(prop,value){return this.state[prop]=void 0},Model.prototype.update=function(state){var prop,ret,value;ret=!0;for(prop in state)value=state[prop],this.set(prop,value)||(ret=!1);return ret},Model}(),module.exports=Model}),rqzt.define("mvstar/lib/event-emitter",function(module,exports,__dirname,__filename,process){var EventEmitter,__slice=[].slice;EventEmitter=function(){function EventEmitter(opts){var _ref;null==opts&&(opts={}),this.debug=null!=(_ref=opts.debug)&&_ref,this._listeners={},this._allListeners=[]}return EventEmitter.prototype.on=function(event,callback){var _base;return event?(null==(_base=this._listeners)[event]&&(_base[event]=[]),this._listeners[event].push(callback),this._listeners[event].length-1):(this._allListeners.push(callback),this._allListeners.length-1)},EventEmitter.prototype.off=function(event,index){return event?void(null!=index?this._listeners[event][index]=null:this._listeners[event]={}):this._listeners={}},EventEmitter.prototype.emit=function(){var args,event,listener,listeners,_i,_j,_len,_len1,_ref;for(event=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[],listeners=this._listeners[event]||[],_i=0,_len=listeners.length;_i<_len;_i++)listener=listeners[_i],null!=listener&&listener.apply(this,args);for(args.unshift(event),_ref=this._allListeners,_j=0,_len1=_ref.length;_j<_len1;_j++)listener=_ref[_j],listener.apply(this,args);if(this.debug)return console.log.apply(console,args)},EventEmitter}(),module.exports=EventEmitter}),rqzt.define("mvstar/lib/route",function(module,exports,__dirname,__filename,process){var Route,pathtoRegexp;pathtoRegexp=rqzt("path-to-regexp"),Route=function(){function Route(path,opts){var prefix;null==opts&&(opts={}),"*"===path&&(path=":star*"),path="/"+path.replace(/^\//,""),null!=opts.prefix&&(prefix=("/"+opts.prefix.replace(/^\//,"")).replace(/\/$/,""),path=prefix+path),this.keys=[],this.regexp=pathtoRegexp(path,this.keys,opts.sensitive,opts.strict),this.path=path}return Route}(),module.exports=Route}),rqzt.define("path-to-regexp",function(module,exports,__dirname,__filename,process){function escapeGroup(group){return group.replace(/([=!:$\/()])/g,"\\$1")}function attachKeys(re,keys){return re.keys=keys,re}function flags(options){return options.sensitive?"":"i"}function regexpToRegexp(path,keys){var groups=path.source.match(/\((?!\?)/g);if(groups)for(var i=0;i<groups.length;i++)keys.push({name:i,delimiter:null,optional:!1,repeat:!1});return attachKeys(path,keys)}function arrayToRegexp(path,keys,options){for(var parts=[],i=0;i<path.length;i++)parts.push(pathToRegexp(path[i],keys,options).source);var regexp=new RegExp("(?:"+parts.join("|")+")",flags(options));return attachKeys(regexp,keys)}function replacePath(path,keys){function replace(_,escaped,prefix,key,capture,group,suffix,escape){if(escaped)return escaped;if(escape)return"\\"+escape;var repeat="+"===suffix||"*"===suffix,optional="?"===suffix||"*"===suffix;return keys.push({name:key||index++,delimiter:prefix||"/",optional:optional,repeat:repeat}),prefix=prefix?"\\"+prefix:"",capture=escapeGroup(capture||group||"[^"+(prefix||"\\/")+"]+?"),repeat&&(capture=capture+"(?:"+prefix+capture+")*"),optional?"(?:"+prefix+"("+capture+"))?":prefix+"("+capture+")"}var index=0;return path.replace(PATH_REGEXP,replace)}function pathToRegexp(path,keys,options){if(keys=keys||[],isArray(keys)?options||(options={}):(options=keys,keys=[]),path instanceof RegExp)return regexpToRegexp(path,keys,options);if(isArray(path))return arrayToRegexp(path,keys,options);var strict=options.strict,end=options.end!==!1,route=replacePath(path,keys),endsWithSlash="/"===path.charAt(path.length-1);return strict||(route=(endsWithSlash?route.slice(0,-2):route)+"(?:\\/(?=$))?"),route+=end?"$":strict&&endsWithSlash?"":"(?=\\/|$)",attachKeys(new RegExp("^"+route,flags(options)),keys)}var isArray=rqzt("isarray");module.exports=pathToRegexp;var PATH_REGEXP=new RegExp(["(\\\\.)","([\\/.])?(?:\\:(\\w+)(?:\\(((?:\\\\.|[^)])*)\\))?|\\(((?:\\\\.|[^)])*)\\))([+*?])?","([.+*?=^!:${}()[\\]|\\/])"].join("|"),"g")}),rqzt.define("isarray",function(module,exports,__dirname,__filename,process){module.exports=Array.isArray||function(arr){return"[object Array]"==Object.prototype.toString.call(arr)}}),rqzt.define("./routes",function(module,exports,__dirname,__filename,process){module.exports={cart:rqzt("./routes/cart"),store:rqzt("./routes/store"),card:rqzt("./routes/card")}}),rqzt.define("./routes/cart",function(module,exports,__dirname,__filename,process){exports.hideHover=function(){return $(".cart-hover").hide()},exports.setupHover=function(){var view;return view=new(rqzt("./views/cart-hover")),app.views.push(view),view.listen()},exports.setupView=function(){var view;return view=new(rqzt("./views/cart")),app.views.push(view),view.render()}}),rqzt.define("./views/cart-hover",function(module,exports,__dirname,__filename,process){var CartHover,View,util,extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;View=rqzt("mvstar/lib/view"),util=rqzt("./util"),CartHover=function(superClass){function CartHover(){return CartHover.__super__.constructor.apply(this,arguments)}return extend(CartHover,superClass),CartHover.prototype.el=".cart-hover",CartHover.prototype.bindings={quantity:".cart-total-quantity",subtotal:".cart-price span",suffix:".cart-suffix"},CartHover.prototype.formatters={subtotal:function(v){return util.formatCurrency(v)},suffix:function(v){return v>1?"items":"item"},quantity:function(v){return v>0&&this.showCart(),util.humanizeNumber(v)}},CartHover.prototype.showCart=function(){return this.el.animate({opacity:1},400,"swing")},CartHover.prototype.listen=function(){var cart,quantity;return cart=app.get("cart"),cart.on("quantity",function(_this){return function(v){return _this.set("quantity",v),_this.set("suffix",v)}}(this)),cart.on("subtotal",function(_this){return function(v){return _this.set("subtotal",v)}}(this)),quantity=cart.get("quantity"),this.set("quantity",quantity),this.set("suffix",quantity),this.set("subtotal",cart.get("subtotal"))},CartHover}(View),module.exports=CartHover}),rqzt.define("mvstar/lib/view",function(module,exports,__dirname,__filename,process){var View,__slice=[].slice;View=function(){function View(opts){var k,name,v,watched,watcher,_base,_i,_len,_ref,_ref1;null==opts&&(opts={}),this.id=this._nextId(this.constructor.name),this._events={},this._targets={},this._watchers={},this.state={},_ref=opts.state;for(k in _ref)v=_ref[k],this.state[k]=v;_ref1=this.watching;for(watcher in _ref1)for(watched=_ref1[watcher],Array.isArray(watched)||(watched=[watched]),_i=0,_len=watched.length;_i<_len;_i++)name=watched[_i],null==(_base=this._watchers)[name]&&(_base[name]=[]),this._watchers[name].push(watcher);this.el=this.$el=this._getEl(opts),this._cacheTargets()}return View.prototype.el=null,View.prototype.bindings={},View.prototype.computed={},View.prototype.events={},View.prototype.formatters={},View.prototype.watching={},View.prototype.mutators=rqzt("mvstar/lib/mutators"),View.prototype._getEl=function(opts){return null!=opts.el?opts.el:this.template?$($(this.template).html()):this.html?$(this.html):$(this.el)},View.prototype._nextId=function(){var counter;return counter=0,function(prefix){var id;return id=++counter+"",null!=prefix?prefix:prefix+id}}(),View.prototype._cacheTarget=function(selector){var err;try{this._targets[selector]=this.$el.find(selector)}catch(_error){err=_error,console.log(err)}},View.prototype._cacheTargets=function(){var attr,name,selector,target,targets,_i,_len,_ref,_ref1;_ref=this.bindings;for(name in _ref)for(targets=_ref[name],Array.isArray(targets)||(targets=[targets]),_i=0,_len=targets.length;_i<_len;_i++)target=targets[_i],"string"==typeof target&&(_ref1=this._splitTarget(target),selector=_ref1[0],attr=_ref1[1],null==this._targets[selector]&&this._cacheTarget(selector))},View.prototype._computeComputed=function(name){var args,sources,src,value,_i,_j,_len,_len1,_ref;for(args=[],_ref=this.watching[name],_i=0,_len=_ref.length;_i<_len;_i++)for(sources=_ref[_i],Array.isArray(sources)||(sources=[sources]),_j=0,_len1=sources.length;_j<_len1;_j++)src=sources[_j],args.push(this.state[src]);return value=this.computed[name].apply(this,args)},View.prototype._mutateDom=function(selector,attr,value){var mutator,_ref;(mutator=null!=(_ref=this.mutators[attr])?_ref:this.mutators.attr)(this._targets[selector],attr,value)},View.prototype._renderBindings=function(name,value){var formatter,target,targets,_i,_len;for(null!=this.computed[name]&&(value=this._computeComputed(name)),targets=this.bindings[name],Array.isArray(targets)||(targets=[targets]),formatter=this.formatters[name],_i=0,_len=targets.length;_i<_len;_i++)target=targets[_i],"string"==typeof target?this._renderSelector(target,value,formatter):this._renderCallback(target,value,name,formatter)},View.prototype._renderSelector=function(target,value,formatter){var attr,selector,_ref;return _ref=this._splitTarget(target),selector=_ref[0],attr=_ref[1],null!=formatter&&(value=formatter.call(this,value,""+selector+" @"+attr)),this._mutateDom(selector,attr,value)},View.prototype._renderCallback=function(target,value,name,formatter){return null!=formatter&&(value=formatter.call(this,value,"callback")),target.call(this,value,name)},View.prototype._splitEvent=function(e){var $el,event,selector,_ref;if(_ref=e.split(/\s+/),event=_ref[0],selector=2<=_ref.length?__slice.call(_ref,1):[],selector=selector.join(" "),!selector)return $el=this.$el,[$el,event];switch(selector){case"document":$el=$(document);break;case"window":$el=$(window);break;default:$el=this.$el.find(selector)}return[$el,event]},View.prototype._splitTarget=function(target){var attr,selector,_ref,_ref1;return target.indexOf(!0)?(_ref=target.split(/\s+@/),selector=_ref[0],attr=_ref[1]):(_ref1=[target,null],selector=_ref1[0],attr=_ref1[1]),null==attr&&(attr="text"),[selector,attr]},View.prototype.get=function(name){return this.state[name]},View.prototype.set=function(name,value){var watcher,watchers,_i,_len;if(this.state[name]=value,null!=this.bindings[name]&&this._renderBindings(name,value),null!=(watchers=this._watchers[name]))for(_i=0,_len=watchers.length;_i<_len;_i++)watcher=watchers[_i],this._renderBindings(watcher)},View.prototype.render=function(state){var k,name,targets,v,_ref;if(null!=state)for(k in state)v=state[k],this.set(k,v);else{_ref=this.bindings;for(name in _ref)targets=_ref[name],this._renderBindings(name,this.state[name])}return this},View.prototype.bindEvent=function(selector,callback){var $el,eventName,_ref;return _ref=this._splitEvent(selector),$el=_ref[0],eventName=_ref[1],"string"==typeof callback&&(callback=this[callback]),$el.on(""+eventName+"."+this.id,function(_this){return function(event){return callback.call(_this,event,event.currentTarget)}}(this)),this},View.prototype.unbindEvent=function(selector){var $el,eventName,_ref;return _ref=this._splitEvent(selector),$el=_ref[0],eventName=_ref[1],$el.off(""+eventName+"."+this.id),this},View.prototype.bind=function(){var callback,selector,_ref;_ref=this.events;for(selector in _ref)callback=_ref[selector],this.bindEvent(selector,callback);return this},View.prototype.unbind=function(){var callback,selector,_ref;_ref=this.events;for(selector in _ref)callback=_ref[selector],this.unbindEvent(selector,callback);return this},View.prototype.remove=function(){return this.$el.remove()},View}(),module.exports=View}),rqzt.define("mvstar/lib/mutators",function(module,exports,__dirname,__filename,process){var mutateAttr,mutateChecked,mutateClass,mutateIndex,mutateText,mutateValue;mutateAttr=function($el,attr,value){return $el.attr(attr,value)},mutateChecked=function($el,attr,value){return $el.prop("checked",value)},mutateClass=function($el,attr,value){var classes;return null==(classes=$el.data("mvstar-original-classes"))&&(classes=$el.attr("class"),$el.data("mvstar-original-classes",classes)),$el.removeClass(),$el.addClass(""+classes+" "+value)},mutateIndex=function($el,attr,value){return $el.prop("selectedIndex",value)},mutateText=function($el,attr,value){return $el.text(value)},mutateValue=function($el,attr,value){return $el.val(value)},module.exports={attr:mutateAttr,checked:mutateChecked,class:mutateClass,index:mutateIndex,selectedIndex:mutateIndex,text:mutateText,value:mutateValue}}),rqzt.define("./util",function(module,exports,__dirname,__filename,process){var humanizeNumber;exports.humanizeNumber=humanizeNumber=function(num){return num.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")},exports.formatCurrency=function(num){var currency;return currency=num||0,humanizeNumber(currency.toFixed(2))},exports.numbersOnly=function(event){return event.charCode>=48&&event.charCode<=57}}),rqzt.define("./views/cart",function(module,exports,__dirname,__filename,process){var CartView,LineItemView,View,util,extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;View=rqzt("mvstar/lib/view"),LineItemView=rqzt("./views/line-item"),util=rqzt("./util"),CartView=function(superClass){function CartView(){return CartView.__super__.constructor.apply(this,arguments)}return extend(CartView,superClass),CartView.prototype.el=".shopping-cart",CartView.prototype.bindings={subtotal:".subtotal .money"},CartView.prototype.formatters={subtotal:function(v){return util.formatCurrency(v)}},CartView.prototype.render=function(){var cart,child,i,index,item,len,ref,ref1,sku,view;$(".cart-content tbody").html(""),index=0,cart=app.get("cart"),cart.on("subtotal",function(_this){return function(v){return _this.set("subtotal",v)}}(this)),cart.on("quantity",function(_this){return function(v){if(0===v)return _this.el.find(".cart-content").animate({opacity:0,height:"0px"},500,function(){return $(this).remove()}),_this.el.find(".empty-message").fadeIn(500)}}(this)),this.set("subtotal",cart.get("subtotal")),ref=cart.getProducts();for(sku in ref){if(item=ref[sku],item.index=++index,null!=item.children)for(ref1=item.children,i=0,len=ref1.length;i<len;i++)child=ref1[i],child.index=++index;view=new LineItemView({state:item}),window.view=view,$(".cart-content tbody").append(view.$el),view.render(),view.bind()}if(0===cart.get("quantity"))return this.el.find(".cart-content").hide(),this.el.find(".empty-message").show()},CartView}(View),module.exports=CartView}),rqzt.define("./views/line-item",function(module,exports,__dirname,__filename,process){var LineItemView,LineSubItemView,View,neverBelowOne,util,validNum,extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;View=rqzt("mvstar/lib/view"),util=rqzt("./util"),validNum=function(v){return"number"==typeof v&&!isNaN(v)},neverBelowOne=function(v){return v<1?1:v},LineSubItemView=function(superClass){function LineSubItemView(){return LineSubItemView.__super__.constructor.apply(this,arguments)}return extend(LineSubItemView,superClass),LineSubItemView.prototype.template="#line-subitem-template",LineSubItemView.prototype.bindings={img:"img.thumbnail   @src",sku:"input.sku       @value",slug:"input.slug      @value",name:"div.title",desc:"div.desc",price:".price .money",quantity:[".quantity input @value",".quantity .text"],index:["input.sku       @name","input.slug      @name",".quantity input @name"]},LineSubItemView.prototype.computed={desc:function(color,size){var i,len,ref,results,v;for(ref=[color,size],results=[],i=0,len=ref.length;i<len;i++)v=ref[i],v&&results.push(v);return results}},LineSubItemView.prototype.watching={desc:["color","size"]},LineSubItemView.prototype.formatters={desc:function(v){return v.join(" / ")},quantity:function(v){return v*=this.get("multiplier")},index:function(v,selector){switch(selector){case"input.sku @name":return"Order.Items."+v+".Variant.SKU";case"input.slug @name":return"Order.Items."+v+".Product.Slug";case".quantity input @name":return"Order.Items."+v+".Quantity"}},price:function(v){return 0===v?(this.el.find(".price span").hide(),this.el.find(".price .free").show()):(this.el.find(".price span").show(),this.el.find(".price .free").hide()),util.formatCurrency(v)}},LineSubItemView.prototype.destroy=function(){return this.unbind(),this.$el.animate({opacity:"toggle"},500,"swing",function(_this){return function(){return _this.$el.remove()}}(this))},LineSubItemView}(View),LineItemView=function(superClass){function LineItemView(){return LineItemView.__super__.constructor.apply(this,arguments)}return extend(LineItemView,superClass),LineItemView.prototype.template="#line-item-template",LineItemView.prototype.bindings={img:"img.thumbnail   @src",sku:"input.sku       @value",slug:"input.slug      @value",name:"div.title",desc:"div.desc",price:".price .money",quantity:".quantity select @value",index:["input.sku       @name","input.slug      @name",".quantity select @name"]},LineItemView.prototype.computed={desc:function(color,size){return[color,size]}},LineItemView.prototype.watching={desc:["color","size"]},LineItemView.prototype.formatters={desc:function(v){return v.length>1?v.join(" / "):v.join("")},index:function(v,selector){switch(selector){case"input.sku @name":return"Order.Items."+v+".Variant.SKU";case"input.slug @name":return"Order.Items."+v+".Product.Slug";case".quantity select @name":return"Order.Items."+v+".Quantity"}},price:function(v){return util.formatCurrency(v)}},LineItemView.prototype.events={"change .quantity select":"updateQuantity","keypress input,select":function(e,el){return 13!==e.keyCode||(this.updateQuantity(e,el),!1)},"click .remove-item":function(){return app.get("cart").removeProduct(this.state.listingSKU),this.destroy()}},LineItemView.prototype.render=function(){var children,i,len,product,results,view;if(LineItemView.__super__.render.apply(this,arguments),this.children=[],children=this.state.children,null!=children){for(results=[],i=0,len=children.length;i<len;i++)product=children[i],view=new LineSubItemView({state:product}),this.el.parent().append(view.el),view.render(),view.bind(),view.set("quantity",this.get("quantity")),results.push(this.children.push(view));return results}},LineItemView.prototype.updateQuantity=function(e,el){var child,i,len,quantity,ref;for(quantity=parseInt($(el).val(),10),console.log(e,el,quantity),validNum(quantity)||(quantity=1),quantity=neverBelowOne(quantity),this.state=$.extend({},this.state),this.set("quantity",quantity),ref=this.children,i=0,len=ref.length;i<len;i++)child=ref[i],child.set("quantity",quantity);return app.get("cart").setProduct(this.state.listingSKU,this.state)},LineItemView.prototype.destroy=function(){var child,i,len,ref,results;for(this.unbind(),this.$el.animate({opacity:"toggle"},500,"swing",function(_this){return function(){return _this.$el.remove()}}(this)),ref=this.children,results=[],i=0,len=ref.length;i<len;i++)child=ref[i],results.push(child.destroy());return results},LineItemView}(View),module.exports=LineItemView}),rqzt.define("./routes/store",function(module,exports,__dirname,__filename,process){var ProductView,Validation;ProductView=rqzt("./views/product"),Validation=rqzt("./Users/dtai/work/verus/crowdstart/assets/js/utils/validation"),exports.setupFormValidation=function(formId,ajax){return null==ajax&&(ajax=!1),function(){var $form,lock,minimumPasswordLength;return minimumPasswordLength=6,lock=!1,$form=$(formId),$form.find("input, select, textarea").click(function(){return $(this).removeClass("error")}),$form.submit(function(){var $errors,confirmPassword,email,empty,error,errors,j,len,missing,oldPassword,password,v,valid;if($form.find(".success").hide(),valid=!0,errors=[],empty=$form.find("div:visible.required > input").filter(function(){return Validation.isEmpty($(this).val())}),email=$form.find('input[name="User.Email"], input[name="Email"]'),0!==email.length&&(Validation.isEmail(email.val())||(valid=!1,Validation.error(email),errors.push("Invalid email."))),oldPassword=$form.find('input[name="OldPassword"]'),0!==oldPassword.length&&(Validation.isPassword(oldPassword.val(),minimumPasswordLength)||(valid=!1,Validation.error(oldPassword),errors.push("Password must be at least "+minimumPasswordLength+" characters long."))),password=$form.find('input[name="Password"]'),0!==password.length&&(Validation.isPassword(password.val(),minimumPasswordLength)?(confirmPassword=$form.find('input[name="ConfirmPassword"]'),0!==confirmPassword.length&&(Validation.passwordsMatch(password.val(),confirmPassword.val())||(valid=!1,Validation.error(confirmPassword),errors.push("Passwords must match.")))):(valid=!1,Validation.error(password),errors.push("Password must be at least "+minimumPasswordLength+" characters long."))),empty.length>0&&(valid=!1,Validation.error(empty),missing=function(){var j,len,ref,results;for(ref=empty.parent().text().split("\n"),results=[],j=0,len=ref.length;j<len;j++)v=ref[j],v.trim()&&results.push(v.toLowerCase().trim());return results}(),missing.length>1?errors.push("Please enter your "+(missing.slice(0,-1).join(", ")+(2===missing.length?"":",")+" and "+missing.slice(-1))+"."):errors.push("Please enter your "+missing[0]+".")),valid){if(ajax)return lock||(lock=!0,$form.find("button[type=submit]").append('<div class="loading-spinner" style="float:left"></div>'),$.ajax({url:$form.attr("action"),type:"POST",data:$form.serializeArray(),dataType:"json",success:function(data){return console.log(data),$form.find(".success").show(),$form.find(".loading-spinner").remove(),$(".errors").text(""),lock=!1},error:function(xhr){var message,ref;return app.set("approved",!1),message=null!=xhr&&null!=(ref=xhr.responseJSON)?ref.message:void 0,"object"==typeof message&&message.length>0&&(message="<p>"+message.join("</p><p>")+"</p>"),null==message&&(message="An error has occured. Please review your information and try again later."),$form.find(".errors").html(message),$form.find(".loading-spinner").remove(),lock=!1}})),!1}else for($errors=$form.find(".errors"),$errors.text(""),j=0,len=errors.length;j<len;j++)error=errors[j],$errors.append($("<p>"+error+"</p>"));return valid})}},exports.setupViews=function(){var div,j,len,ref,results;for(console.log("store#setupViews"),console.log("hi"),ref=$(".product-text"),results=[],j=0,len=ref.length;j<len;j++)div=ref[j],results.push(function(div){var view;return console.log("product"),view=new ProductView({el:$(div)}),window.view=view,app.views.push(view),view.bind(),view.render()}(div));return results},exports.gallery=function(){var fading;return fading=!1,$(document).ready(function(){return $(".product-viewer .gallery .thumbnail").on("click",function(){var gallery,i,images,thumbnail,viewer;if(!fading)return fading=!0,thumbnail=$(this),gallery=thumbnail.parent(),viewer=gallery.parent(),images=viewer.find(".preview"),gallery.children().removeClass("selected"),thumbnail.addClass("selected"),i=$(this).index(),images.hide(),$(images[i]).show(),setTimeout(function(){return fading=!1},300)})})},exports.setupStylesAndSizes=function(){return $(document).ready(function(){return $(".size").val("M"),$(".style").on("change",function(){var config,hasOptions,size,style;if(style=$(this),config=style.parent(),size=config.find(".size"),"Men's T-Shirt"===style.val()){if(hasOptions=!1,size.find("option").each(function(){var option;if(option=$(this),"XXL"===option.val()||"XXXL"===option.val())return hasOptions=!0}),!hasOptions)return size.append($('<option value="XXL">XXL</option>')),size.append($('<option value="XXXL">XXXL</option>'))}else if("Women's T-Shirt"===style.val())return size.find("option").each(function(){var option;if(option=$(this),"XXL"===option.val()||"XXXL"===option.val())return option.remove()})})})},exports.customizeAr1=function(){var $slides,i;return $slides=function(){var j,len,ref,results;for(ref=$("#productSlideshow .slide img"),results=[],j=0,len=ref.length;j<len;j++)i=ref[j],results.push($(i));return results}(),$("[data-variant-option-name=Color]").change(function(){return"Black"===$(this).val()?($slides[0].fadeIn(),$slides[1].fadeOut()):($slides[1].fadeIn(),$slides[0].fadeOut())})},exports.menu=function(){return $(".menu-icon").click(function(){return $("body").toggleClass("mobile")})},exports.toggleDropdown=function(){var _id;return _id=null,$(".dropdown-toggle").click(function(){var $el,first,id;return $el=$(this),id=$el.attr("id"),id===_id?($el.attr("checked",!1),void(_id=null)):($el.attr("checked",!0),_id=id,$(".dropdown-toggle").filter(function(v){return $(this).attr("id")!==id}).each(function(){return $(this).attr("checked",!1)}),first=!0,$(document.body).on("click.dropdown",function(){return first?void(first=!1):($("#"+id).attr("checked",!1),$(document.body).off("click.dropdown"))}))})}}),rqzt.define("./views/product",function(module,exports,__dirname,__filename,process){var ProductView,View,products,extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;View=rqzt("mvstar/lib/view"),products=rqzt("./Users/dtai/work/verus/crowdstart/assets/js/utils/products"),ProductView=function(superClass){function ProductView(){return ProductView.__super__.constructor.apply(this,arguments)}return extend(ProductView,superClass),ProductView.prototype.el=".product-text",ProductView.prototype.bindings={listing:".product-cost .money"},ProductView.prototype.formatters={listing:function(v){var config,cost,j,len,product,ref,variant,variants;for(cost=0,ref=v.Configs,j=0,len=ref.length;j<len&&(config=ref[j],product=allProducts[config.Product],product)&&(variants=product.Variants,variants);j++)""!==config.Variant?variant=variants.some(function(val){return val.Id===config.Variant&&(cost+=parseInt(variant.Price,10),!0)}):cost+=variants.reduce(function(last,current){return Math.min(last,current.Price)},Number.MAX_VALUE),cost-=parseInt(config.PriceAdjustment,10);return this.cost=cost,(1e-4*cost).toFixed(2)+""}},ProductView.prototype.events={"click .add-to-cart":"addToCart"},ProductView.prototype.render=function(){var listing,sku;return sku=this.el.data("sku"),console.log(sku),listing=allListings[sku],console.log(listing),this.set("listing",allListings[sku]),ProductView.__super__.render.apply(this,arguments)},ProductView.prototype.addToCart=function(){var cart,childProducts,config,inner,j,len,listing,listingSKU,product,quantity,ref,ref1,ref2,ref3,ref4,ref5,rootProduct,slug,variant;if(listing=this.get("listing"),slug=listing.Configs[0].Product,null!=(variant=this.getVariant(slug))){for(listingSKU=listing.SKU+variant.SKU,quantity=parseInt(this.el.find("select[name=quantity]").val(),10),product=allProducts[slug],childProducts=[],rootProduct={
listingSKU:listingSKU,sku:variant.SKU,color:variant.Color,img:null!=(ref=product.Images)&&null!=(ref1=ref[0])?ref1.Url:void 0,name:product.Title,price:1e-4*(parseInt(variant.Price,10)-parseInt(listing.Configs[0].PriceAdjustment,10)),quantity:quantity,size:variant.Size,slug:product.Slug,children:childProducts},ref2=listing.Configs,j=0,len=ref2.length;j<len;j++)config=ref2[j],product=allProducts[config.Product],variant=products.getVariant(config.Product,{}),childProducts.push({sku:variant.SKU,color:variant.Color,img:null!=(ref3=product.Images)&&null!=(ref4=ref3[0])?ref4.Url:void 0,name:product.Title,price:1e-4*(parseInt(variant.Price,10)-parseInt(config.PriceAdjustment,10)),multiplier:config.Quantity,size:variant.Size,slug:product.Slug});return inner=this.el.find(".add-to-cart span"),inner.html(""),inner.append('<div class="loading-spinner" style="float:left"></div>'),inner.append('<div class="add-to-cart-adding-text" style="float:right">Adding...</div>'),listing=this.get("listing"),cart=app.get("cart"),(null!=(ref5=cart.getProduct(listingSKU))?ref5.quantity:void 0)+quantity>app.get("maxQuantityPerProduct")?void setTimeout(function(_this){return function(){return _this.el.find(".add-to-cart span").text("Too Many").fadeOut(1e3,function(){return inner.html("Add to Cart"),_this.el.find(".add-to-cart span").fadeIn()})}}(this),500):(cart.addProduct(listingSKU,rootProduct),setTimeout(function(_this){return function(){return _this.el.find(".add-to-cart span").text("Added!").fadeOut(500,function(){return inner.html("Add to Cart"),_this.el.find(".add-to-cart span").fadeIn()})}}(this),500),setTimeout(function(){return $(".cart-hover").animate({opacity:1},400,function(){return $(".cart-hover").animate({opacity:.9},300)})},300))}},ProductView.prototype.getSelectedOptions=function(){var missing,options;return options={},missing=[],this.el.find("select").each(function(i,v){var $select,name,value;$select=$(v),name=$select.attr("name"),"quantity"!==name&&(value=$select.val(),options[name]=value,"none"===value&&missing.push(name))}),[options,missing]},ProductView.prototype.getVariant=function(slug){var alert,missing,options,ref;return ref=this.getSelectedOptions(),options=ref[0],missing=ref[1],missing.length>0?(alert=app.get("alert"),void alert.show({title:"Unable To Add Item",message:"Please select a "+missing[0]+" option.",confirm:"Okay"})):products.getVariant(slug,options)},ProductView}(View),module.exports=ProductView}),rqzt.define("./Users/dtai/work/verus/crowdstart/assets/js/utils/products",function(module,exports,__dirname,__filename,process){var optionsMatch;optionsMatch=function(options,variant){var option,value;for(option in options)if(value=options[option],variant[option]!==value)return!1;return!0},exports.getVariant=function(slug,options){var i,len,ref,variant,variants;for(null==options&&(ref=[slug,null],options=ref[0],slug=ref[1]),variants=null!=slug?allProducts[slug].Variants:currentProduct.Variants,console.log(options,variants),i=0,len=variants.length;i<len;i++)if(variant=variants[i],optionsMatch(options,variant))return variant;if(Object.keys(variant).length>0)throw new Error("Mismatch between product and options");return variants[0]}}),rqzt.define("./Users/dtai/work/verus/crowdstart/assets/js/utils/validation",function(module,exports,__dirname,__filename,process){exports.isEmpty=function(str){return 0===str.trim().length},exports.isEmail=function(email){var pattern;return pattern=new RegExp(/^[+a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/i),pattern.test(email)},exports.isPassword=function(password,length){return password.length>=length},exports.passwordsMatch=function(password,confirmPassword){return password===confirmPassword},exports.error=function(el){return $(el).addClass("error"),$(el).addClass("shake"),setTimeout(function(){return $(el).removeClass("shake")},500)}}),rqzt.define("./routes/card",function(module,exports,__dirname,__filename,process){var $giftCard,$skullyCard,getFontSize,ratio,renderGiftCard,renderImgToCanvas,renderSkullyCard,setActiveCard,toBlob;toBlob=rqzt("blueimp-canvas-to-blob/js/canvas-to-blob"),ratio=.4,$skullyCard=$("#skully-card"),$giftCard=$("#gift-card"),renderImgToCanvas=function(img,canvas){var ctx;canvas.width=img.width*ratio,canvas.height=img.height*ratio,ctx=canvas.getContext("2d"),ctx.scale(ratio,ratio),ctx.drawImage(img,0,0)},getFontSize=function(text,ctx){var fontSize,maxWidth,width;fontSize=300,ctx.font="bold "+fontSize+"px Michroma",ctx.fillStyle="#FFF",maxWidth=1980;try{for(width=ctx.measureText(text).width;width>maxWidth;)fontSize-=.5,ctx.font="bold "+fontSize+"px Michroma",width=ctx.measureText(text).width}catch(error){}return fontSize},renderSkullyCard=function(img,canvas){var ctx,fontSize,name;return name=window.userName.toUpperCase(),ctx=canvas.getContext("2d"),ctx.scale(ratio,ratio),renderImgToCanvas(img,canvas),fontSize=getFontSize(name,ctx),ctx.fillText(name,520,1115+.8*fontSize),canvas.toDataURL()},renderGiftCard=function(img,canvas){var ctx,fontSize,fromName,toName;return fromName=window.userName.toUpperCase(),toName=window.toName.toUpperCase(),ctx=canvas.getContext("2d"),ctx.scale(ratio,ratio),renderImgToCanvas(img,canvas),fontSize=getFontSize(fromName,ctx),ctx.fillText(fromName,520,680+.8*fontSize),fontSize=getFontSize(toName,ctx),ctx.fillText(toName,520,1115+.8*fontSize),canvas.toDataURL()},setActiveCard=function(showGift){var hideImg,showImg,spinner;return showGift?(hideImg=$skullyCard,showImg=$giftCard,$(".recipient").removeClass("hidden")):(hideImg=$giftCard,showImg=$skullyCard,$(".recipient").addClass("hidden")),spinner=$(".loading-spinner"),hideImg.addClass("hidden"),spinner.removeClass("hidden"),setTimeout(function(){return hideImg.addClass("none"),spinner.addClass("hidden"),showImg.removeClass("none"),showImg.removeClass("hidden")},301)},exports.renderCards=function(){var showGift;return showGift=!1,WebFont.load({google:{families:["Michroma"]},active:function(){var canvas,img1,img2,imgBack,recipientId;return canvas=$("<canvas>")[0],img1=$("<img>").attr("src",window.cardName),img2=$("<img>").attr("src",window.giftCardName),imgBack=$("<img>").attr("src",window.cardBack),img1.load(function(){return $skullyCard.attr("src",renderSkullyCard(img1[0],canvas)).removeClass("hidden").removeClass("none"),$(".placeholder").addClass("none"),$(".loading-spinner").addClass("hidden")}),img2.load(function(){return $giftCard.attr("src",renderGiftCard(img2[0],canvas)),$(".placeholder").addClass("none"),$(".loading-spinner").addClass("hidden")}),$(".is-gift input[type=radio]").click(function(){return setActiveCard(showGift="Yes"===$(this).val())}),recipientId=0,$('input[name="Recipient"]').keydown(function(){var spinner;return spinner=$(".loading-spinner"),spinner.removeClass("hidden"),clearTimeout(recipientId),recipientId=setTimeout(function(_this){return function(){return spinner.addClass("hidden"),window.toName=$(_this).val(),$giftCard.attr("src",renderGiftCard(img2[0],canvas))}}(this),300)}),$(".download").click(function(){var $link;return $link=$("<a>"),$link.attr("download","skullycard.png"),$(document.body).append($link),function(){var bufferCanvas,ctx,height,img,width;return img=(showGift?$giftCard:$skullyCard)[0],width=img1[0].width*ratio,height=img1[0].height*ratio,bufferCanvas=$("<canvas>")[0],bufferCanvas.width=width,bufferCanvas.height=2*height,ctx=bufferCanvas.getContext("2d"),ctx.drawImage(img,0,height),ctx.scale(ratio,ratio),ctx.translate(width/ratio,height/ratio),ctx.rotate(Math.PI),ctx.drawImage(imgBack[0],0,0),$link.attr("href",bufferCanvas.toDataURL()),$link.get(0).click()}}()),$(".share").click(function(){var bufferCanvas,ctx,height,img,width;return img=(showGift?$giftCard:$skullyCard)[0],width=img1[0].width*ratio,height=img1[0].height*ratio,bufferCanvas=$("<canvas>")[0],bufferCanvas.width=width,bufferCanvas.height=height,ctx=bufferCanvas.getContext("2d"),ctx.drawImage(img,0,0),$(".share span").prepend('<div class="loading-spinner"></div>'),bufferCanvas.toBlob(function(blob){var filename;return filename="skully-xmas-card/"+Math.random().toString(36).slice(2)+"/skully-xmas-card.png",$.ajax({method:"POST",url:"https://www.googleapis.com/upload/storage/v1/b/"+GCS_BUCKET+"/o?uploadType=media&name="+filename+"&predefinedAcl=publicRead&key="+GCS_API_KEY,processData:!1,contentType:!1,data:blob,headers:{"Content-Type":"image/png","Content-Length":blob.size},success:function(){var shareLink;return shareLink="https://storage.googleapis.com/"+GCS_BUCKET+"/"+filename,$(".share-link").val(shareLink),$(".social-icons .social-facebook").attr("href","http://www.facebook.com/share.php?u="+shareLink),$(".social-icons .social-twitter").attr("href","http://twitter.com/?status=Guess+who+is+getting+a+SKULLY?+%40skullysystems+%23skullyxmas+http%3A%2F%2Fstore.skully.com+"+shareLink),$(".social-icons .social-google").attr("href","http://plus.google.com/share?url="+shareLink),$(".share-options").fadeIn(),$(".share-link").click(function(){return $(this).select()}),$(".share .loading-spinner").remove()},error:function(){return $(".share .loading-spinner").remove()}})})})}})}}),rqzt.define("blueimp-canvas-to-blob/js/canvas-to-blob",function(module,exports,__dirname,__filename,process){!function(window){"use strict";var CanvasPrototype=window.HTMLCanvasElement&&window.HTMLCanvasElement.prototype,hasBlobConstructor=window.Blob&&function(){try{return Boolean(new Blob)}catch(e){return!1}}(),hasArrayBufferViewSupport=hasBlobConstructor&&window.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}}(),BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,dataURLtoBlob=(hasBlobConstructor||BlobBuilder)&&window.atob&&window.ArrayBuffer&&window.Uint8Array&&function(dataURI){var byteString,arrayBuffer,intArray,i,mimeString,bb;for(byteString=dataURI.split(",")[0].indexOf("base64")>=0?atob(dataURI.split(",")[1]):decodeURIComponent(dataURI.split(",")[1]),arrayBuffer=new ArrayBuffer(byteString.length),intArray=new Uint8Array(arrayBuffer),i=0;i<byteString.length;i+=1)intArray[i]=byteString.charCodeAt(i);return mimeString=dataURI.split(",")[0].split(":")[1].split(";")[0],hasBlobConstructor?new Blob([hasArrayBufferViewSupport?intArray:arrayBuffer],{type:mimeString}):(bb=new BlobBuilder,bb.append(arrayBuffer),bb.getBlob(mimeString))};window.HTMLCanvasElement&&!CanvasPrototype.toBlob&&(CanvasPrototype.mozGetAsFile?CanvasPrototype.toBlob=function(callback,type,quality){callback(quality&&CanvasPrototype.toDataURL&&dataURLtoBlob?dataURLtoBlob(this.toDataURL(type,quality)):this.mozGetAsFile("blob",type))}:CanvasPrototype.toDataURL&&dataURLtoBlob&&(CanvasPrototype.toBlob=function(callback,type,quality){callback(dataURLtoBlob(this.toDataURL(type,quality)))})),"function"==typeof define&&define.amd?define(function(){return dataURLtoBlob}):window.dataURLtoBlob=dataURLtoBlob}(this)}),rqzt.define("./models/cart",function(module,exports,__dirname,__filename,process){var Cart,ModelEmitter,cookies,neverBelowZero,validNum,extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;ModelEmitter=rqzt("mvstar/lib/model-emitter"),validNum=function(v){return"number"==typeof v&&!isNaN(v)},neverBelowZero=function(v){return v<0?0:v},cookies={get:function(name){var ref,state;try{return state=null!=(ref=JSON.parse($.cookie(name)))?ref:{}}catch(error){return{}}},set:function(name,state,path,expires){var domain;return domain=null,"localhost"!==location.hostname&&(domain=location.hostname.replace("store.","").replace("checkout.","")),$.cookie(name,JSON.stringify(state),{domain:domain,expires:expires,path:path})}},Cart=function(superClass){function Cart(){return Cart.__super__.constructor.apply(this,arguments)}return extend(Cart,superClass),Cart.prototype.cookieName="SKULLYCart",Cart.prototype.defaults={subtotal:0,quantity:0,products:{}},Cart.prototype.validators={quantity:validNum,subtotal:validNum},Cart.prototype.transforms={quantity:neverBelowZero,subtotal:neverBelowZero},Cart.prototype.fetch=function(){return this.update(cookies.get(this.cookieName))},Cart.prototype.save=function(){return cookies.set(this.cookieName,this.state,"/",30)},Cart.prototype.set=function(k,v){return Cart.__super__.set.apply(this,arguments),this.emit(k,v),console.log("cart:",k,v)},Cart.prototype.getProduct=function(sku){return this.state.products[sku]},Cart.prototype.getProducts=function(){return this.state.products},Cart.prototype._setProduct=function(sku,product){return this.state.products[sku]=product,this.save()},Cart.prototype.setProduct=function(sku,product){var _product,quantity,quantityDiff,subtotal,subtotalDiff;return product=$.extend({},product),quantity=this.get("quantity"),subtotal=this.get("subtotal"),null==this.state.products[sku]?(console.log("new sku"),this.set("quantity",quantity+product.quantity),this.set("subtotal",subtotal+product.quantity*product.price),this._setProduct(sku,product)):(console.log("update existing"),_product=this.state.products[sku],console.log(product,_product),quantityDiff=product.quantity-_product.quantity,subtotalDiff=product.quantity*product.price-_product.quantity*_product.price,console.log("quantityDiff",quantityDiff,"subtotalDiff",subtotalDiff),this.set("quantity",quantity+quantityDiff),this.set("subtotal",subtotal+subtotalDiff),this._setProduct(sku,product))},Cart.prototype.addProduct=function(sku,product){var price,quantity,ref,subtotal;return product=$.extend({},product),price=product.quantity*product.price,quantity=this.get("quantity")+product.quantity,subtotal=this.get("subtotal")+price,null!=(ref=window._fbq)&&ref.push(["track","6018312116522",{value:price.toFixed(),currency:"USD"}]),this.set("quantity",quantity),this.set("subtotal",subtotal),null==this.state.products[sku]?this._setProduct(sku,product):(this.state.products[sku].quantity+=product.quantity,this.save())},Cart.prototype.removeProduct=function(sku){var product,quantity,subtotal;return product=this.state.products[sku],null==product.quantity&&(product.quantity=0),null==product.price&&(product.price=0),quantity=this.get("quantity"),subtotal=this.get("subtotal"),this.set("quantity",quantity-product.quantity),this.set("subtotal",subtotal-product.quantity*product.price),delete this.state.products[sku],this.save()},Cart.prototype.clear=function(){return $.removeCookie(this.cookieName),this.state={},this.setDefaults(),this.set("quantity",0),this.set("subtotal",0),this.save()},Cart}(ModelEmitter),module.exports=Cart}),rqzt.define("./views/alert",function(module,exports,__dirname,__filename,process){var AlertView,View,extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;View=rqzt("mvstar/lib/view"),AlertView=function(superClass){function AlertView(opts){var ref,ref1,ref2,ref3,ref4,ref5;null==opts&&(opts={}),AlertView.__super__.constructor.apply(this,arguments),this.$nextTo=$(null!=(ref=opts.nextTo)?ref:"body"),this.set("confirm",null!=(ref1=opts.confirm)?ref1:"okay"),this.set("cancel",null!=(ref2=opts.cancel)?ref2:"cancel"),this.set("message",null!=(ref3=opts.message)?ref3:"message"),this.set("title",null!=(ref4=opts.title)?ref4:"title"),this.set("autodismiss",null!=(ref5=opts.autodismiss)&&ref5),this.cover=!1}return extend(AlertView,superClass),AlertView.prototype.el=".alert-dialog",AlertView.prototype.bindings={title:".alert-title",message:".alert-message",confirm:".alert-confirmation-button",cancel:".alert-cancel-button"},AlertView.prototype.events={"mousedown document":function(){if(this.get("autodismiss"))return this.dismiss()},"keydown document":function(e){if(get("autodismiss"))return e||(e=event),27===e.keyCode?this.dismiss():void 0},"scroll window":function(){if(this.get("autodismiss"))return this.dismiss()},"click .alert-confirmation-button":function(){if(this.dismiss(),this.onConfirm)return this.onConfirm()},"click .alert-cancel-button":function(){if(this.dismiss(),this.onCancel)return this.onCancel()}},AlertView.prototype.show=function(opts){return null==opts&&(opts={}),null!=opts.title&&this.set("title",opts.title),null!=opts.message&&this.set("message",opts.message),null!=opts.confirm&&this.set("confirm",opts.confirm),null!=opts.cancel&&this.set("cancel",opts.cancel),null!=opts.autodismiss&&this.set("autodismiss",opts.autodismiss),null!=opts.nextTo&&(this.$nextTo=opts.nextTo),null!=opts.cover&&(this.cover=opts.cover),opts.onConfirm&&(this.onConfirm=opts.onConfirm),opts.onCancel&&(this.onCancel=opts.onCancel),this.render(),this.bind(),this.position(),this.$el.finish().fadeIn(200)},AlertView.prototype.dismiss=function(){return this.unbind(),this.$el.finish().fadeOut(200,function(_this){return function(){return _this.$el.css({top:-1e3})}}(this))},AlertView.prototype.position=function(){var offset,topOffset;return offset=this.$nextTo.offset(),this.cover?this.$el.css({position:"absolute",top:offset.top+"px",left:offset.left+"px",width:this.$nextTo.width(),height:this.$nextTo.height()}):(topOffset=offset.top-$(window).scrollTop(),this.$el.css({position:"fixed",top:topOffset-42+"px",left:offset.left-66+"px"}))},AlertView}(View),module.exports=AlertView}),rqzt.define("./store",function(module,exports,__dirname,__filename,process){var App,StoreApp,app,routes,extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;App=rqzt("mvstar/lib/app"),routes=rqzt("./routes"),StoreApp=function(superClass){function StoreApp(){return StoreApp.__super__.constructor.apply(this,arguments)}return extend(StoreApp,superClass),StoreApp.prototype.prefix="/:store?",StoreApp.prototype.routes={"/":[routes.cart.setupHover,routes.store.gallery,routes.store.setupStylesAndSizes,routes.store.setupViews],"/cart":[routes.cart.hideHover,routes.cart.setupView],"/login":[routes.store.setupFormValidation("#loginForm"),routes.store.setupFormValidation("#registerForm")],"/card":routes.card.renderCards,"/register":[routes.store.setupFormValidation("#loginForm"),routes.store.setupFormValidation("#registerForm")],"/profile":[routes.store.setupFormValidation("#profileForm",!0),routes.store.setupFormValidation("#changePasswordForm",!0),routes.store.setupFormValidation("#changeBillingForm",!0),routes.store.setupFormValidation("#changeInfoForm",!0)],"/:prefix?":routes.cart.setupHover,"*":[routes.store.menu,routes.store.toggleDropdown]},StoreApp.prototype.start=function(){var alert,cart;return cart=new(rqzt("./models/cart")),cart.fetch(),alert=new(rqzt("./views/alert"))({nextTo:".sqs-add-to-cart-button"}),this.set("cart",cart),this.set("alert",alert),this.set("maxQuantityPerProduct",10),this.route()},StoreApp}(App),window.app=app=new StoreApp,$(document).ready(function(){return app.start()})}),rqzt("./store")}).call(this,this);